(this["webpackJsonptest-task-vk-development-lab"]=this["webpackJsonptest-task-vk-development-lab"]||[]).push([[0],{113:function(e,t,a){},187:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(27),s=a.n(c),i=(a(113),a(23)),o=a(39),d=a.n(o),l=a(81),u=a(74),p=a(35);function j(e){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.list.reduce((function(e,t){var a={date:t.dt_txt,icon:"http://openweathermap.org/img/wn/".concat(t.weather[0].icon,"@2x.png"),clouds:t.clouds.all,wind:t.wind.speed,temp:t.main.temp,temp_feels_like:t.main.feels_like};return e[t.dt_txt.split(" ")[0]]?e[t.dt_txt.split(" ")[0]].push(a):e[t.dt_txt.split(" ")[0]]=[a],e}),{}),e.abrupt("return",{city_name:t.city.name,country:t.city.country,days:a});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=Object(p.b)("weather/GetWeatherBySityName",function(){var e=Object(u.a)(d.a.mark((function e(t,a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(l.a)(a),e.next=3,fetch("\n            https://api.openweathermap.org/data/2.5/forecast?q=".concat(t,"&appid=").concat("52d1d8f3095914669900b1bcc8569c2e","&units=metric"));case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.next=9,j(r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),f=Object(p.b)("weather/fetchWeather",function(){var e=Object(u.a)(d.a.mark((function e(t,a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(l.a)(a),e.next=3,fetch("\n            https://api.openweathermap.org/data/2.5/forecast?lat=".concat(t.lat,"&lon=").concat(t.lon,"&appid=").concat("52d1d8f3095914669900b1bcc8569c2e","&units=metric"));case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.next=9,j(r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),y=localStorage.getItem("reduxState")?JSON.parse(localStorage.getItem("reduxState")):{sities:[],errors:!1},h=Object(p.c)({name:"weather",initialState:y,reducers:{deleteCity:function(e,t){e.sities=e.sities.filter((function(e){return e.city_name!==t.payload}))},delError:function(e){e.errors=!1}},extraReducers:function(e){e.addCase(m.fulfilled,(function(e,t){e.sities.push(t.payload)})),e.addCase(m.rejected,(function(e){console.log("error"),e.errors=!0})),e.addCase(f.fulfilled,(function(e,t){for(var a=0;a<e.sities.length;a++)if(e.sities[a].city_name==t.payload.city_name)return;e.sities.push(t.payload)})),e.addCase(f.rejected,(function(e){console.log("error")}))}}),x=h.actions,O=x.deleteCity,g=x.delError,w=(h.reducer,a(193)),v=a(190),_=a(191),N=a(105),S=Object(p.c)({name:"alert",initialState:{isAlert:!1,alertData:{message:"",description:"",type:"info"}},reducers:{setAlert:function(e,t){e.alertData=t.payload,e.isAlert=!0},deleteAlert:function(e){e.isAlert=!1}}}),k=S.actions,C=k.setAlert,A=k.deleteAlert,T=(S.reducer,a(6)),I=function(){var e=Object(i.c)((function(e){return e.weather.sities})),t=Object(n.useRef)(null),a=Object(i.b)();return Object(T.jsxs)(v.a,{name:"basic",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(n){t&&t.current&&(t.current.input.value="");for(var r=0;r<e.length;r++)if(e[r].city_name.toLowerCase()===n.cityName.toLowerCase())return void a(C({message:"You can't add a city",description:"The city has already been added",type:"warning"}));a(m(n.cityName))},className:"form",children:[Object(T.jsx)("p",{className:"from__title",children:"Type cities for example london or vladimir"}),Object(T.jsx)(v.a.Item,{label:"city name",name:"cityName",rules:[{required:!0,message:"Please input city name!"}],children:Object(T.jsx)(_.a,{ref:t})}),Object(T.jsx)(v.a.Item,{wrapperCol:{offset:1,span:16},children:Object(T.jsx)(N.a,{className:"submitBtn",type:"primary",htmlType:"submit",children:"Add city"})})]})},E=a(84),P=a(194),D=E.a.TabPane,J=function(e){return Object(T.jsx)(P.a,{className:"weather_card",title:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(e.index).getDay()]+":",children:Object(T.jsx)(E.a,{defaultActiveKey:"0",tabPosition:"top",style:{height:180},children:Object.keys(e.city.days[e.index]).map((function(t,a){return Object(T.jsxs)(D,{tab:e.city.days[e.index][a].date.split(" ")[1].split(":")[0]+":"+e.city.days[e.index][a].date.split(" ")[1].split(":")[1],children:[Object(T.jsx)("img",{className:"weather_image",src:e.city.days[e.index][a].icon,alt:"weather icon"}),Object(T.jsxs)("p",{className:"temperature",children:[Object(T.jsxs)("span",{className:"temperature__main",children:["temperature: ",e.city.days[e.index][a].temp,"\xb0"]}),Object(T.jsxs)("span",{className:"temperature__feels_like",children:["feels like: ",e.city.days[e.index][a].temp_feels_like,"\xb0"]})]}),Object(T.jsxs)("div",{className:"clouds_wind",children:[Object(T.jsxs)("p",{className:"clouds",children:["clouds: ",e.city.days[e.index][a].clouds,"%"]}),Object(T.jsxs)("p",{className:"wind",children:["wind: ",e.city.days[e.index][a].wind," M/s"]})]})]},a)}))})})},W=E.a.TabPane,B=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.weather.sities}));return Object(T.jsx)(E.a,{type:"editable-card",onEdit:function(t){"string"==typeof t?e(O(t)):console.log("create")},defaultActiveKey:"0",hideAdd:!0,tabPosition:"top",children:t.map((function(e,t){return Object(T.jsx)(W,{tab:e.city_name,children:Object.keys(e.days).map((function(t){return Object(T.jsxs)("div",{children:[" ",Object(T.jsx)(J,{index:t,city:e})," "]},t)}))},e.city_name)}))})},M=a(192),q=a(103),F=function(e){var t=Object(i.b)();return Object(n.useEffect)((function(){Object(q.setTimeout)((function(){t(A())}),3e3)}),[]),Object(T.jsx)(M.a,{message:e.message,description:e.description,type:e.type,showIcon:!0})},K=w.a.Header,L=w.a.Sider,R=w.a.Content,Y=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.weather.sities})),a=Object(i.c)((function(e){return e.alert.isAlert})),r=Object(i.c)((function(e){return e.alert.alertData}));return Object(i.c)((function(e){return e.weather.errors}))&&(e(C({message:"You can't add a city",description:"The city was not found",type:"error"})),e(g())),Object(n.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(t){e(f({lat:t.coords.latitude.toString(),lon:t.coords.longitude.toString()}))}))}),[navigator]),Object(T.jsxs)(w.a,{children:[Object(T.jsx)(K,{className:"header",children:Object(T.jsx)("h1",{className:"header__title",children:"Weather"})}),a&&Object(T.jsx)(F,{message:r.message,description:r.description,type:r.type}),Object(T.jsxs)(w.a,{className:"main",children:[Object(T.jsx)(L,{className:"sider",children:Object(T.jsx)(I,{})}),Object(T.jsx)(R,{className:"content",children:JSON.stringify(t).length>3&&Object(T.jsx)(B,{})})]})]})},G=Object(p.a)({reducer:{weather:h.reducer,alert:S.reducer}}),H=(G.subscribe((function(){localStorage.setItem("reduxState",JSON.stringify(G.getState().weather))})),G);s.a.render(Object(T.jsx)(i.a,{store:H,children:Object(T.jsx)(r.a.StrictMode,{children:Object(T.jsx)(Y,{})})}),document.getElementById("root"))}},[[187,1,2]]]);
//# sourceMappingURL=main.46eec1d6.chunk.js.map